<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="/wow/animate.css" />
    <link rel="stylesheet" href="/css/style.css" />
    <title>Quessor Cooker</title>
  </head>

  <body
    class="
      position-relative
      d-flex
      flex-column
      justify-content-center
      align-items-center
    "
  >
    <div class="container col-lg-8 mt-5">
      <h2 class="text-center mb-5">
        Dear <%=gender=="male"? "Mr." : "Miss." %> <%= username %> let's create
        the quiz
      </h2>

      <div class="row g-3 wow fadeInUp mb-5" data-wow-delay="100ms">
        <div
          class="
            d-flex
            justify-content-center
            align-items-center
            responder-question-number
            col-12
          "
        >
          <div
            class="border-top w-100 position-absolute mb-2 border-secondary"
          ></div>
          <p
            type="button"
            class="border d-flex justify-content-center align-items-center"
          >
            1
          </p>
        </div>
        <div class="col-sm-12 col-md-6">
          <input type="text" id="a" class="btn btn-light w-100" value="manik" />
        </div>
        <div class="col-sm-12 col-md-6">
          <button type="button" class="btn btn-light w-100">
            Manikangkan Das
          </button>
        </div>
        <div class="col-sm-12 col-md-6">
          <button type="button" class="btn btn-light w-100">
            Manikangkan Das
          </button>
        </div>
        <div class="col-sm-12 col-md-6">
          <button type="button" class="btn btn-light w-100">
            Manikangkan Das
          </button>
        </div>
      </div>

      <section id="qBoard"></section>

      <button
        id="cook"
        type="button"
        class="btn btn-primary w-100 mb-5"
        data-bs-toggle="modal"
        data-bs-target="#staticBackdrop"
      >
        Damn, let me share the quiz now
      </button>
    </div>
    <!-- alert modal start -->
    <div
      class="modal fade"
      id="staticBackdrop"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
      tabindex="-1"
      aria-labelledby="staticBackdropLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="staticBackdropLabel">Modal title</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">...</div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
            <button type="button" class="btn btn-primary">Understood</button>
          </div>
        </div>
      </div>
    </div>

    <script>
      const gender = "<%=gender%>";
      const date = "<%=date%>";
      const username = "<%=username%>";
    </script>
    <script src="/js/cookScreen_backend.js"></script>

    <!-- <script>
        const optionArr = document.querySelectorAll('.options');
        const answerForm = document.querySelector('#answerForm');


        for (let subOptions of optionArr) {
            const buttonA = subOptions.children[0];
            const buttonB = subOptions.children[1];
            const buttonC = subOptions.children[2];
            const buttonD = subOptions.children[3];


            // future implementation FEATURE will show blank value on button focus and show optionA/b/c/d on leave focus  

            buttonA.addEventListener('click', function (e) {
                e.stopPropagation();
                buttonA.classList.add('active');
                buttonB.classList.remove('active');
                buttonC.classList.remove('active');
                buttonD.classList.remove('active');

            });

            buttonB.addEventListener('click', function (e) {
                e.stopPropagation();
                buttonB.classList.add('active');
                buttonA.classList.remove('active');
                buttonC.classList.remove('active');
                buttonD.classList.remove('active');

            });

            buttonC.addEventListener('click', function (e) {
                e.stopPropagation();
                buttonC.classList.add('active');
                buttonA.classList.remove('active');
                buttonB.classList.remove('active');
                buttonD.classList.remove('active');

            });

            buttonD.addEventListener('click', function (e) {
                e.stopPropagation();
                buttonD.classList.add('active');
                buttonA.classList.remove('active');
                buttonB.classList.remove('active');
                buttonC.classList.remove('active');
            });



        }






        const userDefinedQuestions = {};

        const quesSections = document.querySelectorAll('#ques');
        for (let sec of quesSections) {
            sec.children[0].addEventListener('click', function (e) {
                // console.log('clicked');
                e.stopPropagation();
            })

            sec.addEventListener('click', function () {
                sec.classList.toggle('list-group-item-success');
            })


        }


        const genLinkBtn = document.querySelector("#genLinkBtn");
        genLinkBtn.addEventListener('click', function () {
            const chosenQues = document.querySelectorAll(".list-group-item-success#ques");
            // console.log(chosenQues);

            var allCookedQuesitons = [];


            for (let obj of chosenQues) {

                // console.log(obj.children[1].querySelector('.active'));
                let correctAnsId = obj.children[1].querySelector('.active');
                correctAnsId = (correctAnsId == null) ? null : `option_${correctAnsId.id}`;
                
                
                if(correctAnsId == null ){
                    alert('please activate the correct option of all highlighted questions');
                    return;
                }

                


                var ques1 = {
                    question: obj.children[0].value,
                    option_a: obj.children[1].children[0].value,
                    option_b: obj.children[1].children[1].value,
                    option_c: obj.children[1].children[2].value,
                    option_d: obj.children[1].children[3].value,
                    correctAns: correctAnsId
                }

                // console.log(ques1);
                allCookedQuesitons.push(ques1);
                // console.log(allCookedQuesitons);

                // send the cooked questions post request
                
               


            }
            const _l = allCookedQuesitons.length;
            if(_l !=5){
                    alert(`you have selected ${_l}. Select 5 questions exactly!`);
                    console.log(_l);
                    return;
                }

            // this will be fixed in the future. Right now it gets the job done. nothing is asynchronous
            var xhr = new XMLHttpRequest();
                xhr.open("POST", '/cooked', true);
                xhr.setRequestHeader('Content-Type', 'application/json');
                xhr.send(JSON.stringify({
                    allCookedQuesitons,
                    username :`<%=username%>`,
                    gender :`<%=gender%>`,
                }));
                gottourl();
            
        })


        
        function gottourl(){
            window.location.href = '/<%=username%>/cooked/share';
        }; 
        
        
       




    </script> -->
  </body>
</html>
